import{s as N,u as $,q as O,i as T,d as a,v as q,l as G,o as n,g as H,c as i,b as e,x as C,y as p,z as _,F as f,f as g,h as I,A as S,B as J,t as u,P as Q}from"./index.16d2990d.js";import{f as W,a as v}from"./array.f93e9ab1.js";const X={key:1,class:"wrapper min-h-screen gap-8 my-8 md:my-16"},Y={class:"w-full mx-auto px-6 h-full text-gray-800"},Z={class:"flex xl:justify-center justify-center items-center flex-wrap h-full"},ee={class:"w-full mb-8 md:mb-0"},te=e("h1",{class:"block mb-8 text-[1.5rem]"},"Edit Recipe",-1),se=["onSubmit"],oe={class:"flex flex-col gap-4 md:flex-row md:gap-8 border bg-white rounded-md shadow-lg p-4 mb-8"},ne={class:"w-full"},le={class:"mb-3"},ie=e("label",{for:"exampleFormControlInput1",class:"form-label inline-block mb-2 text-gray-700"},"Name",-1),ae={key:0,class:"block text-rose-500 capitalize mt-2"},re={class:"mb-3"},de=e("label",{for:"exampleFormControlInput1",class:"form-label inline-block mb-2 text-gray-700"},"Description",-1),ce={key:0,class:"block text-rose-500 capitalize mt-2"},ue=e("label",{for:"exampleFormControlInput1",class:"form-label inline-block mb-4 text-gray-700"},"Image",-1),pe={class:"relative w-full md:w-[200px] bg-gradient-to-r from-purple-500 to-pink-500 h-[200px] mb-4"},me={class:"relative border w-full h-full"},he=["src"],_e={for:"dropzone-file",class:"dropzone-file-wrapper absolute bottom-2 right-2 p-2 bg-white rounded-full"},fe=e("span",{class:"bg-white"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 text-sky-500"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})])],-1),ge={class:"flex flex-col"},ve={id:"ingredient-wrapper",class:"border rounded-md bg-white shadow-lg p-4 mb-8"},be=e("label",{for:"exampleFormControlInput1",class:"form-label inline-block mb-4 text-gray-700"},"Ingredients",-1),xe={class:"input-field !flex !items-center !justify-between !mb-4"},we={class:"flex items-center"},ye={class:"flex items-center justify-center text-sm mr-4 w-6 h-6 rounded-full bg-sky-500 text-white"},ke={href:""},Ce=["onClick"],Ie=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5 group-hover:text-white"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),Fe=[Ie],Me={class:"flex items-center gap-4 mb-4"},Re=["onKeydown"],Se={id:"instruction-wrapper",class:"border rounded-md bg-white shadow-lg p-4 mb-8"},Ve=e("label",{for:"exampleFormControlInput1",class:"form-label inline-block mb-4 text-gray-700"},"Instructions",-1),je={class:"input-field !mb-4"},ze={class:"flex justify-between items-center mb-1"},Ae={class:"inline-block py-1 text-sky-500 font-semibold"},Be=["onClick"],Ue=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5 group-hover:text-white"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),Le=[Ue],Pe={class:"flex items-center gap-4 mb-4"},Ee=["onKeydown"],Ke={class:"mb-8"},De=e("label",{for:"exampleFormControlInput1",class:"form-label inline-block mb-2 text-gray-700"},"Status",-1),Ne=e("option",{value:"private"},"Private",-1),$e=e("option",{value:"public"},"Public",-1),Oe=[Ne,$e],Te={class:"mb-8"},qe={type:"submit",class:"btn !w-full md:!w-auto",value:"Submit"},Ge={key:0,class:"spinner-border animate-spin inline-block w-4 h-4 border-4 rounded-full text-green-500",role:"status"},He=e("span",{class:"visually-hidden"},"Loading...",-1),Je=[He],Qe={key:1,class:"text-white"},et={__name:"Edit",setup(We){const V=N(),b=$(),F=O(),j=T(),{$baseUrl:z}=j.appContext.config.globalProperties,M=a(!1),r=a(),d=a(),m=a([]),x=a(!1),w=a(!1),y=a(!1),R=a(null),h=a(null),s=q({name:null,description:null,ingredients:Array(),instructions:Array(),image:null,status:null});G((async()=>{try{y.value=!0,await b.dispatch("getRecipe",F.params.id);const{name:l,description:o,ingredients:t,instructions:c,image:k,status:K,user:D}=b.getters.recipe;R.value=D._id,s.name=l,s.description=o,s.ingredients=t,s.instructions=c,s.status=K,h.value=z+k,h.value&&(M.value=!0)}catch(l){console.log(l)}finally{y.value=!1}})());const A=async()=>{m.value=[],x.value=!1,w.value=!0;const l={id:F.params.id,form:s};try{await b.dispatch("updateRecipe",l),x.value=!0}catch(o){m.value=o.response.data.errors}finally{w.value=!1}!x.value||V.push({name:"user",params:{id:R.value}})},B=async l=>{const o=l.target.files[0],t=await W.fileReaderAsync(o);t&&(M.value=!0,s.image=o),document.getElementById("recipe-image").setAttribute("src",t)},U=()=>{if(!r.value)return console.log("empty");if(v.exist(s.ingredients,r.value))return alert("ingredient already exist");s.ingredients=[...s.ingredients,r.value],r.value=null},L=()=>{if(!d.value)return console.log("empty");if(v.exist(s.instructions,d.value))return alert("instructions already exist");s.instructions=[...s.instructions,d.value],d.value=null},P=l=>{s.ingredients=v.remove(s.ingredients,l)},E=l=>{s.instructions=v.remove(s.instructions,l)};return(l,o)=>y.value?(n(),H(Q,{key:0})):(n(),i("section",X,[e("div",Y,[e("div",Z,[e("div",ee,[te,e("form",{onSubmit:C(A,["prevent"]),method:"POST",enctype:"multipart/form-data"},[e("div",oe,[e("div",ne,[e("div",le,[ie,p(e("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>s.name=t),type:"text",name:"name",class:"input-field",id:"exampleFormControlInput1",placeholder:""},null,512),[[_,s.name]]),(n(!0),i(f,null,g(m.value,t=>(n(),i("div",null,[t.param=="name"?(n(),i("small",ae,u(t.msg),1)):I("",!0)]))),256))]),e("div",re,[de,p(e("textarea",{cols:"3",rows:"3","onUpdate:modelValue":o[1]||(o[1]=t=>s.description=t),name:"description",class:"input-field",id:"exampleFormControlInput1",placeholder:""},`\r
                        `,512),[[_,s.description]]),(n(!0),i(f,null,g(m.value,t=>(n(),i("div",null,[t.param=="description"?(n(),i("small",ce,u(t.msg),1)):I("",!0)]))),256))]),e("div",null,[ue,e("div",pe,[e("div",me,[h.value!=null?(n(),i("img",{key:0,id:"recipe-image",src:h.value,class:"w-full h-full",alt:"recipe-image"},null,8,he)):I("",!0)]),e("label",_e,[fe,e("input",{id:"dropzone-file",onChange:o[2]||(o[2]=t=>B(t)),type:"file",name:"image",class:"hidden"},null,32)])])])])]),e("div",ge,[e("div",ve,[be,(n(!0),i(f,null,g(s.ingredients,(t,c)=>(n(),i("div",xe,[e("div",we,[e("div",ye,u(c+1),1),e("label",ke,u(t),1)]),e("span",{onClick:k=>P(t),class:"remove-ingredient group hover:bg-rose-500 rounded-full"},Fe,8,Ce)]))),256)),e("div",Me,[p(e("input",{onKeydown:S(C(U,["prevent"]),["enter"]),type:"text","onUpdate:modelValue":o[3]||(o[3]=t=>r.value=t),name:"ingredients",class:"input-field",id:"exampleFormControlInput1",placeholder:""},null,40,Re),[[_,r.value]])])]),e("div",Se,[Ve,(n(!0),i(f,null,g(s.instructions,(t,c)=>(n(),i("div",je,[e("div",ze,[e("span",Ae," Step "+u(c+1),1),e("span",{onClick:k=>E(t),class:"group hover:bg-rose-500 rounded-full"},Le,8,Be)]),e("p",null,u(t),1)]))),256)),e("div",Pe,[p(e("textarea",{onKeydown:S(C(L,["prevent"]),["enter"]),"onUpdate:modelValue":o[4]||(o[4]=t=>d.value=t),cols:"3",rows:"3",name:"instructions",class:"input-field text-left",placeholder:""},`\r
                      `,40,Ee),[[_,d.value]])])])]),e("div",Ke,[De,p(e("select",{"onUpdate:modelValue":o[5]||(o[5]=t=>s.status=t),name:"status",class:"input-field"},Oe,512),[[J,s.status]])]),e("div",Te,[e("button",qe,[w.value?(n(),i("div",Ge,Je)):(n(),i("label",Qe,"Update"))])])],40,se)])])])]))}};export{et as default};
